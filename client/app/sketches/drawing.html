<!doctype html>
<html>
  <head>
    <title>Desktop / Phone Drawing</title>
    <script src="../third-party/jquery.js"></script>
    <script src="../third-party/two.js"></script>
    <script src="../third-party/pointer-events/pointerevents.js"></script>
    <script src="../third-party/mdv/mdv.js"></script>
    <script src="../third-party/tween.js"></script>
    <script src="../src/tracker.js"></script>
    <script src="../src/timeline.js"></script>
    <link rel="stylesheet" type="text/css" href="../styles/timeline.css" />
  </head>
  <body>
    <div id="stage"></div>
    <div class="scripts">
      <script>

        $(function() {

          var tracker = new Tracker();
          var timeline = window.timeline = new Timeline();
          document.body.appendChild(timeline.domElement);

          var two = new Two({
            type: Two.Types.canvas,
            fullscreen: true,
            autostart: true
          }).appendTo($('#stage')[0]);

          var mouse = two.makeCircle(0, 0, 50);
          mouse.noFill().stroke = 'red';
          mouse.linewidth = 8;

          two.bind('update', function(count, delta) {
            timeline.update(delta);
          });

          var $window = $(window)
            .bind('click', function() {
              tracker.store();
            })
            .bind('pointermove', function(event) {
              var e = event.originalEvent;
              mouse.translation.set(e.clientX, e.clientY);
              // tracker.add({
              //   time: timeline.now,
              //   x: mouse.translation.x,
              //   y: mouse.translation.y
              // });
            });

          // Sample data

          _.each(_.range(10), function(i) {

            var sample = {
              name: 'object-' + (i + 1),
              x: 0,
              y: 250
            };

            sample.shape = two.makeCircle(sample.x, sample.y, 10);
            sample.shape.noStroke().fill = 'red';
            sample.tween = new TWEEN.Tween(sample)
              .to({ x: 500 * Math.random(), y: 500 * Math.random() }, 5000 * Math.random())
              .onUpdate(function() {
                sample.shape.translation.set(sample.x, sample.y);
              })
              .start(0);

            timeline.add(sample.tween);

          });

        });

      </script>
    </div> 
  </body>
</html>